<div class="siliconflow-extension-settings">
    <!-- 语音功能（TTS）-->
    <div class="inline-drawer">
        <div class="inline-drawer-header inline-drawer-toggle">
            <b>语音功能（TTS）</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down"></div>
        </div>
        <div class="inline-drawer-content" style="display: none;">
            <div class="flex-container">
                <!-- API设置 -->
                <div class="setting-item">
                    <label for="siliconflow_api_key">API密钥：</label>
                    <input id="siliconflow_api_key" type="password" placeholder="输入你的API密钥" />
                </div>
                
                <div class="setting-item">
                    <label for="siliconflow_api_url">API地址：</label>
                    <input id="siliconflow_api_url" type="text" placeholder="例如: https://api.siliconflow.cn/v1" />
                    <small>支持兼容 OpenAI 格式的 API 地址</small>
                </div>
                
                <div class="setting-item button-group">
                    <button id="test_siliconflow_connection" class="menu_button">测试连接</button>
                    <button id="save_siliconflow_settings" class="menu_button">保存设置</button>
                    <span id="connection_status" style="color: red;">未连接</span>
                </div>
                
                <hr class="sysHR">
                
                <!-- 模型选择 (修改部分) -->
                <div class="setting-item">
                    <label for="tts_model">TTS模型：</label>
                    <div style="display: flex; gap: 5px; align-items: center;">
                        <select id="tts_model" style="flex-grow: 1;">
                            <option value="FunAudioLLM/CosyVoice2-0.5B">CosyVoice2-0.5B (默认)</option>
                        </select>
                        <button id="refresh_models" class="menu_button" title="获取/刷新模型列表" style="width: 40px;">
                            <i class="fa-solid fa-rotate"></i>
                        </button>
                    </div>
                    <small>点击右侧按钮从 API 获取可用模型</small>
                </div>
                
                <!-- 音色选择 -->
                <div class="setting-item">
                    <label for="tts_voice">语音角色：</label>
                    <select id="tts_voice">
                        <!-- 这里的选项会由 JS 动态生成 -->
                    </select>
                </div>
                
                <!-- 语速调整 -->
                <div class="setting-item">
                    <label for="tts_speed">语速（0.25-4.0）：</label>
                    <input type="range" id="tts_speed" min="0.25" max="4" step="0.25" value="1" />
                    <span id="tts_speed_value">1.0</span>
                </div>
                
                <!-- 音量增益 -->
                <div class="setting-item">
                    <label for="tts_gain">音量增益（-10到10）：</label>
                    <input type="range" id="tts_gain" min="-10" max="10" step="1" value="0" />
                    <span id="tts_gain_value">0</span>
                </div>
                
                <!-- 自动播放设置 -->
                <div class="setting-item">
                    <label>
                        <input type="checkbox" id="auto_play_audio" checked />
                        自动朗读角色消息
                    </label>
                </div>
                
                <div class="setting-item">
                    <label>
                        <input type="checkbox" id="auto_play_user" />
                        自动朗读用户消息
                    </label>
                </div>
                
                <!-- 克隆音色功能 -->
                <div class="sub-section">
                    <h4>克隆音色功能</h4>
                    <div class="setting-item">
                        <label for="clone_voice_name">音色名称：</label>
                        <input type="text" id="clone_voice_name" placeholder="例如: my_voice_1" pattern="[a-zA-Z0-9_\-]+" />
                    </div>
                    <div class="setting-item">
                        <label for="clone_voice_text">参考文本：</label>
                        <input type="text" id="clone_voice_text" placeholder="输入音频对应的文本内容" />
                    </div>
                    <div class="setting-item">
                        <label for="clone_voice_audio">参考音频：</label>
                        <input type="file" id="clone_voice_audio" accept="audio/*" />
                    </div>
                    <div class="setting-item">
                        <button id="upload_voice" class="menu_button">上传克隆音色</button>
                        <button id="refresh_custom_voices" class="menu_button">刷新音色列表</button>
                    </div>
                    <div class="setting-item">
                        <label>已克隆的音色：</label>
                        <div id="custom_voices_list" style="margin-top: 10px;">
                            <small>暂无自定义音色</small>
                        </div>
                    </div>
                </div>
                
                <hr class="sysHR">
                
                <!-- 文本截取设置 -->
                <div class="sub-section">
                    <h4>文本截取设置</h4>
                    <div class="setting-item">
                        <label for="image_text_start">开始标记：</label>
                        <input type="text" id="image_text_start" placeholder="例如：（ 或 " value="" />
                    </div>
                    <div class="setting-item">
                        <label for="image_text_end">结束标记：</label>
                        <input type="text" id="image_text_end" placeholder="例如：） 或 " value="" />
                    </div>
                </div>
                
                <!-- TTS测试 -->
                <div class="sub-section">
                    <h4>TTS测试</h4>
                    <div class="setting-item">
                        <textarea id="tts_test_text" placeholder="输入测试文本...">你好，这是一个测试语音。</textarea>
                        <button id="test_tts" class="menu_button">生成测试语音</button>
                        <div id="tts_output"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
